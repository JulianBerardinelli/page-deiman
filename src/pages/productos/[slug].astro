---
import Layout from '~/layouts/PageLayout.astro';
import Header from '~/components/widgets/Header.astro';
import FindUs from '~/components/widgets/FindUs.astro';
import SupportOverview from '~/components/widgets/SupportOverview.astro';
import ProductCarousel from '~/components/widgets/carousels/ProductCarousel.astro';
import ProductDetailSwitch from '~/components/widgets/ProductDetailSwitch.astro';
import ProductDetailSingle from '~/components/widgets/ProductDetailSingle.astro';
import { headerData } from '~/navigation';
import { products } from '~/data/products';

export function getStaticPaths() {
  return products.map((product) => ({
    params: { slug: product.slug },
    props: { product },
  }));
}

const { product } = Astro.props;

const metadata = {
  title: product.name,
  description: product.metaDescription,
};
---

<Layout metadata={metadata}>
  <Fragment slot="header">
    <Header
      {...headerData}
      actions={[
        {
          variant: 'primary',
          text: 'Contacto',
          href: '/contact',
        },
      ]}
      isSticky
    />
  </Fragment>

  <ProductCarousel slides={product.slides} />

  {product.variants ? (
    <ProductDetailSwitch id={`${product.slug}-detalle`} title={product.heroTitle} description={product.heroDescription}>
      <Fragment slot="industrial">
        <div class="space-y-4">
          <h3 class="text-xl font-semibold text-primary">{product.variants.industrial.headline}</h3>
          <p class="text-muted">{product.variants.industrial.description}</p>
          <ul class="list-disc pl-5 text-muted">
            {product.variants.industrial.highlights.map((item) => (
              <li>{item}</li>
            ))}
          </ul>
        </div>
      </Fragment>
      <Fragment slot="semiIndustrial">
        <div class="space-y-4">
          <h3 class="text-xl font-semibold text-primary">{product.variants.semiIndustrial.headline}</h3>
          <p class="text-muted">{product.variants.semiIndustrial.description}</p>
          <ul class="list-disc pl-5 text-muted">
            {product.variants.semiIndustrial.highlights.map((item) => (
              <li>{item}</li>
            ))}
          </ul>
        </div>
      </Fragment>
    </ProductDetailSwitch>
  ) : (
    <ProductDetailSingle
      id={`${product.slug}-detalle`}
      title={product.heroTitle}
      description={product.heroDescription}
      badge={product.single?.badge}
    >
      <Fragment slot="content">
        <div class="space-y-4">
          <h3 class="text-xl font-semibold text-primary">{product.single?.headline}</h3>
          <p class="text-muted">{product.single?.description}</p>
          <ul class="list-disc pl-5 text-muted">
            {(product.single?.highlights ?? []).map((item) => (
              <li>{item}</li>
            ))}
          </ul>
        </div>
      </Fragment>
    </ProductDetailSingle>
  )}

  <FindUs />

  <SupportOverview />
</Layout>
