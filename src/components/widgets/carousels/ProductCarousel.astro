---
import Carousel from '~/components/ui/Carousel.astro';
import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro';

interface Slide {
  image: string | ImageMetadata;
  mobileImage?: string | ImageMetadata;
  title: string;
  subtitle: string;
  align?: 'center' | 'right';
}

interface Props {
  slides?: Slide[];
}

const { slides = [] } = Astro.props as Props;

const defaultSlides: Slide[] = [
  {
    image: '/images/carousel/car-1.jpg',
    mobileImage: '/images/carousel/car-1-phone.jpg',
    title: 'Sabores pensados para <span class="text-yellow-300">cada aplicación</span>',
    subtitle:
      'Desarrollos consistentes y seguros para acompañar todo tipo de procesos con ingredientes seleccionados.',
    align: 'center',
  },
  {
    image: '/images/carousel/car-2.jpg',
    mobileImage: '/images/carousel/car-1-phone.jpg',
    title: 'Soluciones con <span class="text-yellow-300">respaldo técnico</span>',
    subtitle:
      'Acompañamos desde la formulación hasta la producción con asesoramiento experto y adaptabilidad.',
    align: 'right',
  },
];

const resolvedSlides = slides.length > 0 ? slides : defaultSlides;
---

<Carousel>
  {
    resolvedSlides.map((slide) => (
      <div class="carousel-slide relative">
        <picture>
          {slide.mobileImage && (
             typeof slide.mobileImage === 'string' ? (
                <source srcset={slide.mobileImage} media="(max-width: 768px)" />
             ) : (
                <source srcset={slide.mobileImage.src} media="(max-width: 768px)" />
             )
          )}
          {typeof slide.image === 'string' ? (
             <img src={slide.image} alt="Carousel Deiman" class="absolute inset-0 w-full h-full object-cover -z-10" />
          ) : (
             <Image src={slide.image} alt="Carousel Deiman" class="absolute inset-0 w-full h-full object-cover -z-10" />
          )}
        </picture>

        <div
          class:list={[
            'absolute inset-0 flex text-white px-6 sm:px-10 md:px-20',
            slide.align === 'right' ? 'items-center justify-end' : 'items-center justify-center',
          ]}
        >
          <div class:list={['max-w-2xl drop-shadow-md', slide.align === 'right' ? 'text-right' : 'text-center']}>
            <h2 class="text-3xl sm:text-4xl md:text-5xl font-bold mb-6 uppercase" set:html={slide.title} />
            <hr
              class:list={[
                'w-20 sm:w-24 border-t-2 border-yellow-200 mb-6',
                slide.align === 'right' ? 'ml-auto' : 'mx-auto',
              ]}
            />
            <p class="text-base sm:text-lg md:text-xl leading-relaxed" set:html={slide.subtitle} />
          </div>
        </div>
      </div>
    ))
  }
</Carousel>
