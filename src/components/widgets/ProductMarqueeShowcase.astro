---
const { title = 'Conocé nuestros productos para el hogar', subtitle = 'Una nueva línea pensada para acompañar cada momento en casa.', ctaText = 'Saber más', ctaHref = '/productos', showCta = true, products = [
  {
    src: '/images/products/escencia-dulcedeleche.png',
    alt: 'Esencia sabor dulce de leche',
  },
  {
    src: '/images/products/escencia-durazno.png',
    alt: 'Esencia sabor durazno',
  },
  {
    src: '/images/products/escencia-frutilla.png',
    alt: 'Esencia sabor frutilla',
  },
  {
    src: '/images/products/escencia-vainilla.png',
    alt: 'Esencia sabor vainilla',
  },
  {
    src: '/images/products/escencia-limon.png',
    alt: 'Esencia sabor limón',
  },
  {
    src: '/images/products/frutos-del-bosque.png',
    alt: 'Esencia sabor frutos del bosque',
  },
  {
    src: '/images/products/colorante-rojo.png',
    alt: 'Colorante rojo',
  },
  {
    src: '/images/products/colorante-naranja.png',
    alt: 'Colorante naranja',
  },
  {
    src: '/images/products/colorante-amarillo.png',
    alt: 'Colorante amarillo',
  },
  {
    src: '/images/products/colorante-verde.png',
    alt: 'Colorante verde',
  },
  {
    src: '/images/products/colorante-azul.png',
    alt: 'Colorante azul',
  },
  {
    src: '/images/products/colorante-violeta.png',
    alt: 'Colorante violeta',
  },
  {
    src: '/images/products/escencia-coco.png',
    alt: 'Esencia sabor coco',
  },
] } = Astro.props;

const marqueeItems = [...products, ...products];
---
<section class="relative min-h-[520px] overflow-x-hidden overflow-y-visible py-20 sm:min-h-[560px] sm:py-28">
  <div class="pointer-events-none absolute inset-0 bg-gradient-to-b from-white via-white to-slate-50"></div>

  <div class="absolute inset-x-0 top-8 bottom-8 z-0 hidden space-y-3 sm:block sm:space-y-4">
    <div class="marquee-shell">
      <div class="marquee-fade marquee-fade-left"></div>
      <div class="marquee-fade marquee-fade-right"></div>
      <ul class="marquee-track flex w-max items-center gap-10 py-3 sm:gap-14">
        {marqueeItems.map((item, index) => (
          <li
            class="group relative flex h-28 w-28 flex-shrink-0 items-center justify-center rounded-3xl bg-white shadow-[0_16px_28px_rgba(15,23,42,0.12)] ring-1 ring-black/5 transition duration-300 hover:-translate-y-1 sm:h-36 sm:w-36"
            aria-hidden={index >= products.length ? 'true' : undefined}
          >
            <img
              src={item.src}
              alt={item.alt}
              loading="lazy"
              decoding="async"
              class="h-20 w-auto object-contain transition duration-300 group-hover:scale-110 sm:h-28"
            />
            <span class="absolute -bottom-6 left-1/2 w-max -translate-x-1/2 rounded-full bg-white/90 px-3 py-1 text-[0.6rem] font-semibold text-slate-700 opacity-0 shadow-md transition duration-300 group-hover:opacity-100 sm:text-[0.65rem]">
              {item.alt}
            </span>
          </li>
        ))}
      </ul>
    </div>
    <div class="marquee-shell">
      <div class="marquee-fade marquee-fade-left"></div>
      <div class="marquee-fade marquee-fade-right"></div>
      <ul class="marquee-track marquee-track-reverse flex w-max items-center gap-10 py-3 sm:gap-14">
        {marqueeItems.map((item, index) => (
          <li
            class="group relative flex h-28 w-28 flex-shrink-0 items-center justify-center rounded-3xl bg-white shadow-[0_16px_28px_rgba(15,23,42,0.12)] ring-1 ring-black/5 transition duration-300 hover:-translate-y-1 sm:h-36 sm:w-36"
            aria-hidden={index >= products.length ? 'true' : undefined}
          >
            <img
              src={item.src}
              alt={item.alt}
              loading="lazy"
              decoding="async"
              class="h-20 w-auto object-contain transition duration-300 group-hover:scale-110 sm:h-28"
            />
            <span class="absolute -bottom-6 left-1/2 w-max -translate-x-1/2 rounded-full bg-white/90 px-3 py-1 text-[0.6rem] font-semibold text-slate-700 opacity-0 shadow-md transition duration-300 group-hover:opacity-100 sm:text-[0.65rem]">
              {item.alt}
            </span>
          </li>
        ))}
      </ul>
    </div>
  </div>

  <div class="relative mx-auto max-w-6xl px-4 sm:px-6 lg:px-8">
    <div class="relative mx-auto mb-12 max-w-md sm:mb-16 sm:max-w-xl">
      <div
        class="absolute -left-5 top-4 h-full w-full rounded-[28px] bg-white shadow-[0_18px_40px_rgba(15,23,42,0.12)]"
      ></div>
      <div
        class="relative z-10 rounded-[28px] bg-primary px-4 py-4 text-center text-white shadow-[0_22px_60px_rgba(239,68,68,0.45)] sm:px-8 sm:py-7 intersect-once intersect-quarter motion-safe:md:opacity-0 motion-safe:md:intersect:animate-fade"
      >
        <p class="text-[0.55rem] font-semibold uppercase tracking-[0.28em] text-white/80 sm:text-[0.65rem] sm:tracking-[0.3em]">Próximamente</p>
        <h2 class="mt-2 text-lg font-semibold leading-tight sm:text-2xl">
          {title}
        </h2>
        <p class="mt-2 text-[0.7rem] text-white/80 sm:text-sm">
          {subtitle}
        </p>
        {showCta && ctaText && ctaHref ? (
          <div class="mt-3 flex justify-center sm:mt-4">
            <a
              href={ctaHref}
              class="inline-flex items-center justify-center rounded-full bg-white px-4 py-2 text-[0.65rem] font-semibold text-primary shadow-lg shadow-black/20 transition duration-300 hover:-translate-y-0.5 hover:bg-white/90 sm:px-5 sm:text-xs"
            >
              {ctaText}
            </a>
          </div>
        ) : null}
      </div>
    </div>
  </div>

  <div class="relative mx-auto max-w-6xl px-4 sm:hidden">
    <div class="marquee-shell">
      <div class="marquee-fade marquee-fade-left"></div>
      <div class="marquee-fade marquee-fade-right"></div>
      <ul class="marquee-track flex w-max items-center gap-10 py-3">
        {marqueeItems.map((item, index) => (
          <li
            class="group relative flex h-28 w-28 flex-shrink-0 items-center justify-center rounded-3xl bg-white shadow-[0_16px_28px_rgba(15,23,42,0.12)] ring-1 ring-black/5 transition duration-300 hover:-translate-y-1"
            aria-hidden={index >= products.length ? 'true' : undefined}
          >
            <img
              src={item.src}
              alt={item.alt}
              loading="lazy"
              decoding="async"
              class="h-20 w-auto object-contain transition duration-300 group-hover:scale-110"
            />
            <span class="absolute -bottom-6 left-1/2 w-max -translate-x-1/2 rounded-full bg-white/90 px-3 py-1 text-[0.6rem] font-semibold text-slate-700 opacity-0 shadow-md transition duration-300 group-hover:opacity-100">
              {item.alt}
            </span>
          </li>
        ))}
      </ul>
    </div>
  </div>
</section>

<style>
  .marquee-shell {
    position: relative;
    overflow-x: hidden;
    overflow-y: visible;
    padding: 0.5rem 0;
  }

  .marquee-fade {
    position: absolute;
    top: 0;
    bottom: 0;
    width: 5.5rem;
    pointer-events: none;
    z-index: 2;
  }

  .marquee-fade-left {
    left: 0;
    background: linear-gradient(90deg, #fff 0%, rgba(255, 255, 255, 0.9) 40%, transparent 100%);
  }

  .marquee-fade-right {
    right: 0;
    background: linear-gradient(270deg, #fff 0%, rgba(255, 255, 255, 0.9) 40%, transparent 100%);
  }

  .marquee-track {
    animation: marquee 35s linear infinite;
  }

  .marquee-track:hover {
    animation-play-state: paused;
  }

  .marquee-track-reverse {
    animation-direction: reverse;
  }

  @keyframes marquee {
    0% {
      transform: translateX(0);
    }
    100% {
      transform: translateX(-50%);
    }
  }
</style>
